openapi: 3.1.0
info:
  title: NHE CONNECT API
  version: "1.0"
  description: |-
    # 概要
    * このドキュメントではNHE CONNECT API ver.1の仕様について説明します。
    * APIを利用して、NHE CONNECTの警報情報やアイコン情報の取得・操作を行うことができます。

    ## アイコン情報
    アイコン情報とは、NHE CONNECTの船体図上に表示するアイコンの情報で、火災探知装置、その他の検知器、消化設備、カメラ、乗組員等を表現します。
    - Zone-Addressで一意に識別されます。
    - アイコン種別によって、値の有無やステータスの有無、表示/非表示の制御有無、リセット指示可否が異なります。
    - 火災探知装置以外のアイコン種別はサーバの設定により異なります。
    - 火災探知装置のアイコン種別には以下があります。
      - Heat (熱探知器)
      - Smoke (煙探知器)
      - Multi (マルチ探知器)
      - Flame (炎探知器)
      - MCP (手動発信器)
      - Other (その他機器) ※アイコン情報未登録の火災探知装置の情報

    - 操作系APIは以下を満たす場合に実行可能です。実行不可の場合は、ステータスコード`403 Forbidden`を返却します。

      - APIクライアントに該当APIの実行権限が付与されていること。
      - APIクライアントに対象とするアイコン種別への実行権限が付与されていること。
      - 該当APIが対象とするアイコン種別に対し実行可能であること。（下記表、参照）

        |操作系API|実行可のアイコン種別|
        |----|----|
        |アイコン情報値更新/削除|火災探知装置以外で値あり|
        |アイコン情報ステータス更新/削除|火災探知装置以外でステータスあり|
        |アイコン情報可視化/非可視化|火災探知装置以外で表示/非表示制御あり|
        |アイコン情報位置移動|全ての種別|
        |警報リセット|火災探知装置 または 火災探知装置以外のリセット指示可能なアイコン種別/ステータスのアイコン情報 ※1|
        |火災警報テスト発報|火災探知装置 ※1|
        |故障承認|火災探知装置 ※1|
        |無効化実行|火災探知装置 ※1|
        |無効解除|火災探知装置 ※1|
    
        ※1 サーバの設定で指示機能が有効の場合にのみ実行可能

    - 以下の情報リスト取得系APIでは、クエリパラメータで`link=true`を付加することで、その情報行に対し操作可能なAPI情報(Link情報)を確認することができます。
      - アイコン情報リスト取得
      - 警報情報リスト取得
      - 故障情報リスト取得

    ## 認証
    APIの利用にあたって以下を行う必要があります。
    * APIクライアントのIPアドレス事前登録
      * APIは指定IPアドレスからのリクエストのみを受け付けます。
    * 利用する操作系APIと対象とするアイコン種別の申請
    * 全てのリクエストに、所定のAPIキーを指定した`X-API-Key`リクエストヘッダーの付加
      ```http
      X-API-Key: {APIキー}
      ```
    
    ## リクエスト
    * APIとの全ての通信にはHTTPSプロトコルを使用します。
    * URIで指定するpathパラメータやqueryパラメータ、リクエストボディとその構成プロパティで`required`(`*`)の記載があるものは必ず指定してください。
    * 文字コードはUTF-8を使用してください。
    * リクエストボディを送信する際は、以下のリクエストヘッダーを指定してください。
      ```http
      Content-Type: application/json;
      ```
    
    ### 制限
    * 各APIクライアント毎に単位時間当たりのリクエスト回数に制限を設けています。
    * 制限に達した場合は、ステータスコード`429 Too Many Request`を返し、`Retry-After`レスポンスヘッダーでリクエスト可能になるまでの待機時間(秒)を示します。
    
    ## レスポンス
    * HTTPステータスコードで処理結果を返し、追加の情報がある場合はレスポンスボディにJSON形式で返します。
    * レスポンスボディの文字コードはUTF-8です。
    
    ### エラーレスポンス
    エラーが発生した場合は、レスポンスボディに以下の形式でエラー情報を返します。
    ```json
    {
      "title": {エラーコード},
      "detail": {エラーメッセージ},
      "errors": [
        {
          "title": {エラーコード},
          "detail": {エラーメッセージ},
          "field": {エラー項目}
        },
        ...
      ]
    }
    ```
    ※`errors`は項目別の詳細エラーが存在する場合にのみ含まれます。
    
    #### エラーコード一覧
    |HTTPステータス|エラーコード|レイヤ|説明|
    |----|----|----|----|
    |400|invalid_param|T|リクエストのパラメータが不正です。|
    ||missing_param|D|必須パラメータが設定されていません。|
    ||unknown_param|D|未定義のパラメータです。|
    ||invalid_format|D|パラメータのフォーマットが不正です。|
    |401|unauthorized|T|認証できませんでした。(APIキーの誤り等)|
    |403|operation_not_allowed|T|操作は許可されていません。(権限なし)|
    |403|no_value_icon|T|値を登録できないアイコンです。|
    |403|no_status_icon|T|ステータスを登録できないアイコンです。|
    |403|non_hidden_icon|T|表示/非表示制御不可のアイコンです。|
    |403|reset_not_allowed|T|リセット指示が許可されていません。|
    |403|firealarm_test_not_allowed|T|火災警報テスト発報指示が許可されていません。|
    |403|acknowledge_not_allowed|T|故障承認指示が許可されていません。|
    |403|disable_not_allowed|T|無効化指示が許可されていません。|
    |403|re_enable_not_allowed|T|無効解除指示が許可されていません。|
    |404|not_found|T|指定された情報が存在しません。|
    |415|unsupported_media_type|T|不正なContent-Typeです。|
    |422|unprocessable_content|T|リクエストのパラメータ内容が不正です。|
    ||unavailable_status|D|指定できないステータスです。|
    ||unknown_type|D|存在しないアイコン種別です。|
    ||out_of_range|D|値が範囲外です。|
    ||unavailable_char|D|登録不可の文字が含まれています。(制御文字、サロゲートペア、結合文字)|
    ||string_length_exceeded|D|文字数が超過しています。|
    ||no_link_icon|D|リンクを持たないアイコンです。|
    ||disable_unavailable_due_to_fault|D|故障中のため無効化できません。|
    |429|too_many_requests|T|リクエスト回数が上限に達しました。|
    |500|server_error|T|システムエラーが発生しています。|

    ※レイヤ: T=トップ(`/title`)、D=詳細(`/errors/{n}/title`)

    <br><br>
  contact:
    name: 日本舶用エレクトロニクス株式会社
    url: https://www.nhe.co.jp/
    #email: {TODO 必要に応じてemailを指定してください。}
  #termsOfService: {TODO 必要に応じて利用規約のURLを指定してください。}
servers:
  - url: https://{server_ip}
    description: Template
    variables:
      server_ip:
        default: "127.0.0.1"
        description: サーバのIPアドレス
  - url: http://localhost
    description: Local Test
tags:
  - name: icons
    description: アイコン情報にアクセスします。
  - name: alerts
    description: 火災等の警報情報にアクセスします。
  - name: faults
    description: 故障情報にアクセスします。
  - name: disablement
    description: 無効化情報にアクセスします。
paths:
  /api/v1/icons:
    get:
      operationId: getIcons
      tags:
        - icons
      summary: アイコン情報リスト取得
      description: |
        アイコン情報のリストを返します。
        * 並び順はZone-Addressの昇順です。
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
        - $ref: '#/components/parameters/Type'
        - $ref: '#/components/parameters/ZPosition'
        - $ref: '#/components/parameters/Link'
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Icon'
              examples:
                Link情報あり:
                  value:
                    - type: Multi
                      zone_address: 001-01
                      description: "Tech.No: 000001"
                      deck: Main Deck
                      visible: true
                      values:
                        - value: 0.12
                          unit: "%/m"
                          min: 0
                          max: 3.0
                          thresholds: [2.3]
                        - value: 22.1
                          unit: ℃
                          min: -25
                          max: 55
                          thresholds: [40, 50]
                      x_pos: "0.0234567890123"
                      y_pos: "0.0234567890123"
                      z_pos: "3"
                      "_links":
                        position:
                          href: /icons/001-01/position
                          methods: [PUT]
                        disable:
                          href: /disablement?zone_address=001-01
                          methods: [PUT,DELETE]
                        alert_test:
                          href: /alerts/test/001-01
                          methods: [PUT]
                    - type: Gas
                      zone_address: 101-01
                      description: Gas G5-1
                      deck: Main Deck
                      visible: true
                      values:
                        - value: 0.12
                          unit: ppm
                          min: 0
                          max: 2.0
                          thresholds: [1.0, 1.5, 1.8]
                      x_pos: "0.1234567890123"
                      y_pos: "0.1234567890123"
                      z_pos: "3"
                      update_at: 2024-02-26 12:34:56
                      "_links":
                        value:
                          href: /icons/101-01/value
                          methods: [PUT]
                        status:
                          href: /icons/101-01/status
                          methods: [PUT,DELETE]
                        position:
                          href: /icons/101-01/position
                          methods: [PUT]
                    - type: Fiber
                      zone_address: 801-01
                      description: Fiber Sensor
                      deck: Main Deck
                      visible: true
                      x_pos: "0.2234567890123"
                      y_pos: "0.2234567890123"
                      z_pos: "3"
                      update_at: 2024-02-20 12:34:56
                      "_links":
                        status:
                          href: /icons/801-01/status
                          methods: [PUT,DELETE]
                        position:
                          href: /icons/801-01/position
                          methods: [PUT]
                        visible:
                          href: /icons/801-01/visible
                          methods: [PUT,DELETE]
                Link情報なし:
                  value:
                    - type: Multi
                      zone_address: 001-01
                      description: "Tech.No: 000001"
                      deck: Main Deck
                      visible: true
                      values:
                        - value: 0.12
                          unit: "%/m"
                          min: 0
                          max: 3.0
                          thresholds: [2.3]
                        - value: 22.1
                          unit: ℃
                          min: -25
                          max: 55
                          thresholds: [40, 50]
                      x_pos: "0.0234567890123"
                      y_pos: "0.0234567890123"
                      z_pos: "3"
                    - type: Gas
                      zone_address: 101-01
                      description: Gas G5-1
                      deck: Main Deck
                      visible: true
                      values:
                        - value: 0.12
                          unit: ppm
                          min: 0
                          max: 2.0
                          thresholds: [1.0, 1.5, 1.8]
                      x_pos: "0.1234567890123"
                      y_pos: "0.1234567890123"
                      z_pos: "3"
                      update_at: 2024-02-26 12:34:56
                    - type: FE
                      zone_address: 801-01
                      description: Fire extinguisher
                      deck: Main Deck
                      visible: true
                      x_pos: "0.2234567890123"
                      y_pos: "0.2234567890123"
                      z_pos: "3"
                      update_at: 2024-02-20 12:34:56
        '204':
          $ref: '#/components/responses/204_NoContent'
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '422':
          description: |
            Unprocessable Content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                アイコン種別不正:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: unknown_type
                        detail: Unknown type
                        field: type
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/icons/{zone_address}/value:
    put:
      operationId: putIconValue
      tags:
        - icons
      summary: アイコン情報値更新
      description: |
        アイコン情報の値を更新します。
        * 火災探知装置以外で値を持つアイコン種別のアイコン情報のみが対象です。
        * 登録した値はNHE CONNECTで表示します。
          * 下限(`min`)/上限(`max`)の登録がある場合はメーターで表示します。
            * 下限≦値≦上限である必要があります。
          * 下限/上限に加えて閾値(`thresholds`)の登録がある場合は、メーター上の閾値の位置に目盛りを表示し、値が閾値を超えた場合に警告色でメーター/値/単位を表示します。
            * 下限＜閾値＜上限である必要があります。
          * 下限(`min`)/上限(`max`)の登録がない場合は、値と単位のみを表示します。
            * 閾値(`thresholds`)の登録がある場合は、閾値超過時に値/単位を警告色で表示します。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      requestBody: 
        required: true
        description: |
          登録する値関連の項目をjsonで指定してください。
          * 指定された項目のみが登録され、それ以外の項目は更新されません。
          * `thresholds`は指定の要素数で上書きします。（例えば3つの閾値を登録していた所に2つの閾値で再登録した場合、閾値は全部で2つとして扱います。）
        content:
          application/json: 
            schema:
              $ref: '#/components/schemas/IconValue'
      responses:
        '200':
          description: |
            OK
            * 指定のアイコン情報に値を登録しました。
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    description: 登録時点のアイコン情報の値情報
                    required:
                      - zone_address
                    properties:
                      zone_address:
                        $ref: '#/components/schemas/ZoneAddress'
                  - $ref: '#/components/schemas/IconValue'
              examples:
                正常登録:
                  value:
                    zone_address: 001-01
                    value: 12
                    unit: "%"
                    min: 0
                    max: 100
                    thresholds:
                      - 50
                      - 80
                      - 90
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NoValue'
        '404':
          $ref: '#/components/responses/404'
        '415':
          $ref: '#/components/responses/415'
        '422':
          description: |
            Unprocessable Content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                "値/閾値範囲外":
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: out_of_range
                        detail: Out of range (Between min and max)
                        field: value
                      - title: out_of_range
                        detail: Out of range (Between min and max)
                        field: thresholds[1]
                閾値数超過:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: 	out_of_range
                        detail: Out of range (Between 1 and 3)
                        field: thresholds
                単位文字数超過:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: string_length_exceeded
                        detail: "String length exceeds maximum: 6"
                        field: unit
                不正文字列:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: unavailable_char
                        detail: Contained unavailable characters
                        field: unit
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
    delete:
      operationId: deleteIconValues
      tags:
        - icons
      summary: アイコン情報値削除
      description: |
        アイコン情報の値を削除します。
        * 火災探知装置以外で値を持つアイコン種別のアイコン情報のみが対象です。
        * 値と共に登録した単位/上限/下限/閾値も削除します。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定のアイコン情報の値を削除しました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NoValue'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/icons/{zone_address}/status:
    put:
      operationId: putIconStatus
      tags:
        - icons
      summary: アイコン情報ステータス更新
      description: |
        アイコン情報のステータスを更新します。
        * 火災探知装置以外でステータスを持つアイコン種別のアイコン情報のみが対象です。
        * 登録したステータスはNHE CONNECTで表示します。
          * リンク強制表示(`force_show_link`) に`true`を指定した場合、アイコン情報に登録されているリンク先を、NHE CONNECTを使用中のクライアントで強制的にダイアログで表示します。
        * リセット指示状態の維持(`keep_reset`)に`true`を指定した場合、リセット指示中の場合にその状態を維持します。`false`の場合はリセット指示中の状態を解除します。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      requestBody: 
        required: true
        description: |
          登録するステータス関連の項目をjsonで指定してください。
          * 指定された項目のみが登録され、それ以外の項目は更新されません。
        content:
          application/json: 
            schema:
              allOf:
                - $ref: '#/components/schemas/IconStatus'
                - type: object
                  properties:
                    keep_reset:
                      type: boolean
                      default: false
                      description: |
                        リセット指示状態の維持
                        * `true`: リセット指示中の場合、その状態を維持します。
                        * `false`: リセット指示中の状態を解除します。（リセット指示なしの状態に変更します。）
                      examples: [true]
      responses:
        '200':
          description: |
            OK
            * 指定のアイコン情報にステータスを登録しました。
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    description: 登録時点のアイコン情報のステータス情報
                    required:
                      - zone_address
                      - time
                    properties:
                      zone_address:
                        $ref: '#/components/schemas/ZoneAddress'
                      time:
                        $ref: '#/components/schemas/Time'
                  - $ref: '#/components/schemas/IconStatus'
                  - type: object
                    properties:
                      resetting:
                        $ref: '#/components/schemas/Resetting'
              examples:
                正常登録:
                  value:
                    zone_address: 001-01
                    time: 2024-01-31 12:00:00
                    status: Gas
                    message: "Gas detected.\nLevel 3"
                    force_show_link: true
                    resetting: true
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NoStatus'
        '404':
          $ref: '#/components/responses/404'
        '415':
          $ref: '#/components/responses/415'
        '422':
          description: |
            Unprocessable Content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                対象外ステータス:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: unavailable_status
                        detail: Unavailable status
                        field: status
                不正文字列:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: unavailable_char
                        detail: Contained unavailable characters
                        field: message
                文字数超過:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: string_length_exceeded
                        detail: "String length exceeds maximum: 200"
                        field: message
                リンクを持たないアイコン:
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: no_link_icon
                        detail: No link icon
                        field: force_show_link
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
    delete:
      operationId: deleteIconStatus
      tags:
        - icons
      summary: アイコン情報ステータス削除
      description: |
        アイコン情報のステータスを削除します。
        * 火災探知装置以外でステータスを持つアイコン種別のアイコン情報のみが対象です。
        * ステータスと共に登録したメッセージも削除します。
        * リセット指示中の状態を解除します。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定のアイコン情報のステータスを削除しました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NoStatus'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/icons/{zone_address}/visible:
    put:
      operationId: putIconVisible
      tags:
        - icons
      summary: アイコン情報可視化
      description: |
        船体図上のアイコン情報を表示状態にします。
        * 火災探知装置以外で表示/非表示制御可のアイコン種別のアイコン情報のみが対象です。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定のアイコン情報を表示状態にしました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotVisible'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
    delete:
      operationId: deleteIconVisible
      tags:
        - icons
      summary: アイコン情報非可視化
      description: |
        船体図上のアイコン情報を非表示状態にします。
        * 火災探知装置以外で表示/非表示制御可のアイコン種別のアイコン情報のみが対象です。
        * アイコン情報がステータスを持つ場合、非表示指定でも強制的に画面表示されます。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定のアイコン情報を非表示状態にしました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotVisible'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/icons/{zone_address}/position:
    put:
      operationId: putIconPosition
      tags:
        - icons
      summary: アイコン情報位置移動
      description: |
        アイコン情報の位置を移動します。
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      requestBody: 
        required: true
        description: |
          移動する位置をjsonで指定してください。
          * x_pos, y_pos, z_posのいずれか1つ以上の項目を指定する必要があります。
          * 指定された項目のみが登録され、それ以外の項目は更新されません。
        content:
          application/json: 
            schema:
              $ref: '#/components/schemas/IconPosition'
      responses:
        '200':
          description: |
            OK
            * 指定のアイコン情報を移動しました。
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    description: 登録時点のアイコン情報の位置情報
                    required:
                      - zone_address
                    properties:
                      zone_address:
                        $ref: '#/components/schemas/ZoneAddress'
                  - $ref: '#/components/schemas/IconPosition'
                required:
                  - x_pos
                  - y_pos
                  - z_pos
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '404':
          $ref: '#/components/responses/404'
        '415':
          $ref: '#/components/responses/415'
        '422':
          description: |
            Unprocessable Content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                "値範囲外":
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: 	out_of_range
                        detail: Out of range (Between 0 and 100)
                        field: x_pos
                      - title: 	out_of_range
                        detail: Out of range (Between 1 and 7)
                        field: z_pos
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/alerts:
    get:
      operationId: getAlerts
      tags:
        - alerts
      summary: 警報情報リスト取得
      description: |
        警報情報のリストを返します。(故障情報除く)
        * 警報情報は火災警報、及びAlertレベルのステータス情報で構成されます。
        * 並び順は`time`の降順、`zone_address`の昇順です。
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
        - $ref: '#/components/parameters/Link'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Alert'
              examples:
                Link情報あり:
                  value:
                    - type: Multi
                      zone_address: 001-01
                      description: "Tech.No: 000001"
                      deck: Main Deck
                      time: 2024-01-12 11:22
                      status: Fire Alarm
                      message: Gest Room 1001[Fire alarm]
                      "_link":
                        reset:
                          href: /alerts/reset?zone_address=001-01
                          methods: [PUT]
                    - type: Gas
                      zone_address: 101-01
                      description: Gas G5-1
                      deck: Main Deck
                      time: 2024-01-12 11:00:14
                      status: Gas
                      resetting: true
                Link情報なし:
                  value:
                    - type: Multi
                      zone_address: 001-01
                      description: "Tech.No: 000001"
                      deck: Main Deck
                      time: 2024-01-12 11:22
                      status: Fire Alarm
                      message: Gest Room 1001[Fire alarm]
                    - type: Gas
                      zone_address: 101-01
                      description: Gas G5-1
                      deck: Main Deck
                      time: 2024-01-12 11:00:14
                      status: Gas
                      resetting: true
        '204':
          $ref: '#/components/responses/204_NoContent'
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/alerts/reset:
    put:
      tags:
        - alerts
      summary: 警報リセット
      description: |
        警報にリセット指示します。
        * 以下が対象です。
          * 火災探知装置の火災警報
            * 実行によって火災探知装置制御盤に対しリセット指示を行います。
          * 火災探知装置以外のリセット指示可能なアイコン種別を持つアイコン情報の、リセット指示可能なステータス情報
            * 実行によってステータス情報にリセット指示中の状態(リセット指示状態=true)を追加します。（外部機器に対し直接リセット指示は行いません。）
            * リセット指示中の状態はNHE CONNECTで表示し、警報情報リスト取得APIのリスト情報で公開します。
        * サーバ設定で火災警報またはAlertレベルのステータスに対しリセット指示可の場合のみに実行可能です。
        * リセット指示によってリセットが成功したかどうかの情報は返しません。

        ### クエリパラメータ
        クエリパラメータの`zone`、`zone_address`で対象を指定します。
        * 火災探知装置の場合、対象の火災警報有無に関わらず実行します。（火災警報がない場合でもエラー扱いとしません。）
        * 火災探知装置以外の場合、リセット指示中の状態有無に関わらず実行します。（既にリセット指示中の状態でもエラー扱いとしません。）

        | `zone` | `zone_address` | リセット指示対象 |
        | ---- | ---- | ---- |
        | - | - | 全ての火災警報、及びリセット指示可能なステータス情報※1 |
        | 〇 | - | 指定のZoneを持つZone-Address |
        | - | 〇 | 指定のZone-Address |
        | 〇 | 〇 | 指定のZoneを持つZone-Addressと指定のZone-Address|

        ※1 APIクライアントが操作指示可能なアイコン種別の範囲に限られます。


      operationId: putAlertReset
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定の警報にリセット指示しました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotResettable'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/alerts/test/{zone_address}:
    put:
      tags:
        - alerts
      summary: 火災警報テスト発報
      description: |
        火災警報をテスト発報します。
        * 火災探知装置のみが対象です。
        * サーバ設定で火災警報テスト発報指示可の場合のみに実行可能です。
        * 火災警報テスト発報指示によってテスト発報が成功したかどうかの情報は返しません。

      operationId: putAlertsTest
      parameters:
        - $ref: '#/components/parameters/ID-Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定のアイコン情報に火災警報テスト発報指示しました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotFireAlarmTestable'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []

  /api/v1/faults:
    get:
      tags:
        - faults
      summary: 故障情報リスト取得
      description: |
        故障情報のリストを返します。
        * 並び順は`time`の降順、`zone_address`の昇順です。
      operationId: getFaults
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
        - $ref: '#/components/parameters/Link'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Fault'
              examples:
                Link情報あり:
                  value:
                    - type: Multi
                      zone_address: 001-01
                      description: "Tech.No: 000001"
                      deck: Main Deck
                      time: 2024-01-12 11:22
                      fault_status: Serviced
                      message: "FAULT: No reply zone 001 address 01 technical number 000001 Serviced[Gest room 101]"
                      _link:
                        acknowledge:
                          href: /faults/acknowledge?zone_address=001-01
                          methods: [PUT]
                    - type: Other
                      time: 2024-01-12 11:21
                      message: "FAULT: Charger, control unit 01"
                    - type: Other
                      description: "Tech.No: 000002"
                      time: 2024-01-12 11:20
                      fault_status: Acknowledged
                      message: "FAULT: Battery, technical number 000002 Acknowledged"
                    - type: Gas
                      zone_address: 101-01
                      description: Gas G5-1
                      deck: Main Deck
                      time: 2024-01-12 11:00:02
                Link情報なし:
                  value:
                    - type: Multi
                      zone_address: 001-01
                      description: "Tech.No: 000001"
                      deck: Main Deck
                      time: 2024-01-12 11:22
                      fault_status: Serviced
                      message: "FAULT: No reply zone 001 address 01 technical number 000001 Serviced[Gest room 101]"
                    - type: Other
                      time: 2024-01-12 11:21
                      message: "FAULT: Charger, control unit 01"
                    - type: Other
                      description: "Tech.No: 000002"
                      time: 2024-01-12 11:20
                      fault_status: Acknowledged
                      message: "FAULT: Battery, technical number 000002 Acknowledged"
                    - type: Gas
                      zone_address: 101-01
                      description: Gas G5-1
                      deck: Main Deck
                      time: 2024-01-12 11:00:02
        '204':
          $ref: '#/components/responses/204_NoContent'
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/faults/acknowledge:
    put:
      tags:
        - faults
      summary: 故障承認
      description: |
        故障情報に承認指示をします。
        * 火災探知装置の故障情報のみが対象です。
        * サーバ設定で承認指示可の場合のみに実行可能です。
        * 承認指示によって承認が成功したかどうかの情報は返しません。
        ### クエリパラメータ
        クエリパラメータの`zone`、`zone_address`で対象を指定します。
        * 対象の故障有無に関わらず実行します。（未承認の故障がない場合でもエラー扱いとしません。）

        | `zone` | `zone_address` | 承認指示対象 |
        | ---- | ---- | ---- |
        | - | - | 全ての火災探知装置の故障情報 |
        | 〇 | - | 指定のZoneを持つZone-Address |
        | - | 〇 | 指定のZone-Address |
        | 〇 | 〇 | 指定のZoneを持つZone-Addressと指定のZone-Address|

      operationId: putFaultsAcknowledge
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
      responses:
        '204':
          description: |
            No Content
            * 指定の故障情報に承認指示しました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotAcknowledgeable'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
  /api/v1/disablement:
    put:
      tags:
        - disablement
      summary: 無効化実行
      description: |
        無効化指示を実行します。
        * 火災探知装置のみが対象です。
        * サーバ設定で無効化指示可の場合のみに実行可能です。
        * 無効化指示によって無効化が成功したかどうかの情報は返しません。
        ### クエリパラメータ
        クエリパラメータの`zone`、`zone_address`で対象を指定します。
        * `zone`/`zone_address`のどちらか、あるいは両方を必ず指定してください。
        * 対象の無効化状態有無に関わらず実行します。（既に無効化状態の場合でもエラー扱いとしません。）

        | `zone` | `zone_address` | 無効化対象 |
        | ---- | ---- | ---- |
        | - | - | 指示不可（エラー） |
        | 〇 | - | 指定のZone(Zone単位) |
        | - | 〇 | 指定のZone-Address(Zone-Address単位) |
        | 〇 | 〇 | 指定のZone(Zone単位)と指定のZone-Address(Zone-Address単位) |

        * `zone_address`で指定した対象に未承認の故障情報がある場合は無効化不可のためエラーとなります。

      operationId: putDisablementZoneAddress
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
        - name: recovery_time
          in: query
          description: |
            無効状態の自動解除時間を、現時刻から最大24時間後までの時間で、4桁の数字で指定します。
            * 最小: `0000`
            * 最大: `2359`
            * 例) 5:28 ⇒ 0528
          required: true
          example: "0158"
          schema:
            type: string
            pattern: '^([01][0-9]|2[0-3])[0-5][0-9]$'
      responses:
        '204':
          description: |
            No Content
            * 指定のZoneまたはZone-Addressに無効化指示をしました。
        '400':
          $ref: '#/components/responses/400InvalidRecoveryTime'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotDisable'
        '404':
          $ref: '#/components/responses/404'
        '422':
          description: |
            Unprocessable Content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                "故障中":
                  value:
                    title: unprocessable_content
                    detail: Unprocessable Content
                    errors:
                      - title: disable_unavailable_due_to_fault
                        detail: Disable unavailable due to fault
                        field: zone_address
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
    delete:
      tags:
        - disablement
      summary: 無効解除
      description: |
        無効解除指示を実行します。
        * 火災探知装置のみが対象です。
        * サーバ設定で無効解除指示可の場合のみに実行可能です。
        * 無効解除指示によって無効解除が成功したかどうかの情報は返しません。
        ### クエリパラメータ
        クエリパラメータの`zone`、`zone_address`で対象を指定します。
        * 対象の無効化状態有無に関わらず実行します。（既に無効解除状態の場合でもエラー扱いとしません。）

        | `zone` | `zone_address` | 無効解除対象 |
        | ---- | ---- | ---- |
        | - | - | 無効化状態の全Zone/Zone-Address |
        | 〇 | - | 指定のZone(Zone単位) |
        | - | 〇 | 指定のZone-Address(Zone-Address単位) |
        | 〇 | 〇 | 指定のZone(Zone単位)と指定のZone-Address(Zone-Address単位) |

      operationId: deleteDisablement
      parameters:
        - $ref: '#/components/parameters/Zone'
        - $ref: '#/components/parameters/Zone-Address'
      responses:
        '204':
          description: |
            No Content
            - 無効解除指示をしました。
        '400':
          $ref: '#/components/responses/400'
        '401':
          $ref: '#/components/responses/401'
        '403':
          $ref: '#/components/responses/403NotReEnable'
        '404':
          $ref: '#/components/responses/404'
        '429':
          $ref: '#/components/responses/429'
        '500':
          $ref: '#/components/responses/500'
      security:
        - api_key: []
components:
  parameters:
    Zone:
     name: zone
     in: query
     description: |
       Zoneで対象を絞り込みます。(Zone番号部の完全一致)
       * 000形式のみを受け付けます。
     required: false
     example: "001"
     schema:
       $ref: '#/components/schemas/Zone'
    Zone-Address:
      name: zone_address
      in: query
      description: |
        Zone-Addressで対象を絞り込みます。(完全一致)
        * 000-00形式のみを受け付けます。
      required: false
      example: 001-01
      schema:
        $ref: '#/components/schemas/ZoneAddress'
    Type:
      name: type
      in: query
      description: |
        アイコン種別で対象を絞り込みます。(完全一致)
        * 存在するアイコン種別を指定する必要があります。
      required: false
      example: Heat
      schema:
        $ref: '#/components/schemas/Type'
    ZPosition:
      name: z_pos
      in: query
      description: |
        フロア番号で対象を絞り込みます。(完全一致)
        * フロア番号は最下層を`1`として、上方向へ順に数字が割り当てられています。
      required: false
      example: 3
      schema:
        $ref: '#/components/schemas/ZPosition'
    Limit:
      name: limit
      in: query
      description: |
        返却する件数を指定します。
        * 指定がない、または`0`を指定した場合は全件を返却します。
      required: false
      example: 1000
      schema:
        type: integer
        minimum: 0
        default: 0
    Offset:
      name: offset
      in: query
      description: |
        返却対象から除外する先頭からの件数を指定します。
        * 指定がない、または`0`を指定した場合は先頭から返却します。
      required: false
      example: 0
      schema:
        type: integer
        minimum: 0
        default: 0
    Link:
      name: link
      in: query
      description: |
        Link情報(各行の情報に関連するAPI情報)を含めるかどうかを指定します。
        * `true`: Link情報を含める
        * `false`: Link情報を含めない(デフォルト)
      required: false
      example: true
      schema:
        type: boolean
        default: false
    ID-Zone-Address:
      name: zone_address
      in: path
      description: |
        対象のZone-Addressを指定します。
        * 000-00形式のみを受け付けます。
      required: true
      example: 001-01
      schema:
        $ref: '#/components/schemas/ZoneAddress'
    ID-Zone-Or-Zone-Address:
      name: zone_or_zone_address
      in: path
      description: |
        対象のZoneまたはZone-Addressを指定します。
        * 000形式または000-00形式のみを受け付けます。
      required: true
      examples:
        Zone-Address:
          value: 001-01
        Zone:
          value: "001"
      schema:
        oneOf:
          - $ref: '#/components/schemas/ZoneAddress'
          - $ref: '#/components/schemas/Zone'
  schemas:
    Type:
      type: string
      description: |
        アイコン種別
      examples: [Heat,Smoke,MCP]
    Time:
      type: string
      pattern: '^\d{4}-\d{2}-\d{2} \d{2}:\d{2}(:\d{2})?$'
      description: |
        更新日時 (yyyy-mm-dd HH:mi[:ss]形式)
        * NHE CONNECTのシステム時刻基準(火災探知装置制御盤時刻またはサーバ時刻)
      examples: ["2024-01-31 12:00:00"]
    Zone:
      type: string
      pattern: '^\d{3}$'
      description: |
        Zone番号
        * 000形式
      examples: ["001"]
    ZoneAddress:
      type: string
      pattern: '^\d{3}-\d{2}$'
      description: |
        Zone-Address番号
        * アイコン情報の識別子
        * 000-00形式 
          * 前3桁 = Zone番号
          * 後2桁 = Address番号
      examples: ["001-01"]
    TechNo:
      type: string
      pattern: '^\d{6}$'
      description: |
        テクニカル番号
        * 火災探知装置の識別子
        * 火災探知装置のアイコン情報の場合のみ存在
        * 000000形式
      examples: ["000001"]
    Description:
      type: string
      description: |
        アイコン情報の説明
        * 火災探知装置の場合はテクニカル番号
          * "Tech.No: 000000"形式
      examples: ["Gas Detector G01-2","Tech.No: 000001"]
    XPosition:
      type: string
      pattern: '^\d+(\.\d+)?$'
      description: |
        船体図(船首方向=右)上のX座標 (%) 
        * 左端: `0`
        * 右端: `100`
        * 単位(%)は省き、数値のみを桁落ちを防ぐために文字列で指定
        * システムで扱える精度を超える場合は端数を四捨五入します。
      examples: ["50.12345678901234"]
    YPosition:
      type: string
      pattern: '^\d+(\.\d+)?$'
      description: |
        船体図(船首方向=右)上のY座標 (%) 
        * 上端: `0`
        * 下端: `100`
        * 単位(%)は省き、数値のみを桁落ちを防ぐために文字列で指定
        * システムで扱える精度を超える場合は端数を四捨五入します。
      examples: ["50.12345678901234"]
    ZPosition:
      type: string
      pattern: '^\d+$'
      description: |
        船体図上のフロア番号
        * 最下層から順に`1`,`2`,...の数値を文字列で指定
        * ※桁落ちの恐れはないがX/Y座標に合わせ文字列での指定
      examples: ["3"]
    Value:
      type: number
      format: double
      description: |
        値
        * IEEE754倍精度の数値を指定
          * 桁数が多い場合はシステム表示時に切捨て表示
        * 下限(`min`)/上限(`max`)がある場合はその範囲内の値を指定
      examples: [12.30]
    Unit:
      type: 
        - string
        - 'null'
      description: |
        値の単位
        * 制御文字・サロゲートペア・合成文字は不可
        * 6文字まで登録可(超える場合はエラー)
      examples: [℃]
    Deck:
      type: string
      description: |
        デッキ名
      examples: [Main Deck]
    Status:
      type: string
      description: |
        ステータス
        * 該当アイコン情報のアイコン種別に対して使用可能なステータスを指定
      examples: [Gas]
    Icon:
      type: object
      description: |
        アイコン情報
        * `values`は値情報を持つ場合に含まれます。
        * `update_at`は火災探知装置以外のアイコン種別の場合に含まれます。
      properties:
        type:
          $ref: '#/components/schemas/Type'
        zone_address:
          $ref: '#/components/schemas/ZoneAddress'
        description:
          $ref: '#/components/schemas/Description'
        deck:
          $ref: '#/components/schemas/Deck'
        visible:
          type: boolean
          description: |
            表示状態
            * `true`: 表示
            * `false`: 非表示
        values:
          type: array
          description: |
            値のリスト
            * 値を持つ場合にのみ存在 (1～2件)
              * マルチ探知器の場合のみ温度と減光率の2件を持つ
          items:
            $ref: '#/components/schemas/IconValue'
        x_pos:
          $ref: '#/components/schemas/XPosition'
        y_pos:
          $ref: '#/components/schemas/YPosition'
        z_pos:
          $ref: '#/components/schemas/ZPosition'
        update_at:
          $ref: '#/components/schemas/Time'
        "_links":
          description: |
            アイコン情報に対し実行可能なAPIが存在する場合に各Link情報を付加します。
            * queryパラメータで`link=true`の指定がある場合にのみ付加します。

            |プロパティ名|API|備考|
            |----|----|----|
            |`value`|アイコン情報値更新/削除|-|
            |`status`|アイコン情報ステータス更新/削除|-|
            |`position`|アイコン情報位置移動|-|
            |`visible`|アイコン情報可視化/非可視化|現状態に関わらず、可視化/非可視化、両方の情報を示します。|
            |`disable`|無効化実行/無効解除|現状態に関わらず、無効化/無効解除、両方の情報を示します。|
            |`alert_test`|火災警報テスト発報|現状態に関わらず情報を示します。|
          type: object
          properties:
            value:
              $ref: '#/components/schemas/Link'
            status:
              $ref: '#/components/schemas/Link'
            position:
              $ref: '#/components/schemas/Link'
            visible:
              $ref: '#/components/schemas/Link'
            disable:
              $ref: '#/components/schemas/Link'
            alert_test:
              $ref: '#/components/schemas/Link'
      required:
        - type
        - zone_address
        - deck
        - visible
        - x_pos
        - y_pos
        - z_pos
    IconValue:
      description: |
        アイコンの値情報
      type: object
      properties:
        value:
          $ref: '#/components/schemas/Value'
          examples: [12]
        unit:
          $ref: '#/components/schemas/Unit'
          examples: ["%"]
        min:
          type: 
            - number
            - 'null'
          format: double
          description: |
            値 下限
            * IEEE754倍精度の数値を指定
            * 上限(`max`)よりも小さい値を指定
          examples: [0]
        max:
          type: 
            - number
            - 'null'
          format: double
          description: |
            値 上限
            * IEEE754倍精度の数値を指定
            * 下限(`min`)よりも大きい値を指定
          examples: [100]
        thresholds:
          type:
            - array
            - 'null'
          minItems: 1
          maxItems: 3
          items:
            type: number 
            format: double
            description: |
              値 閾値
              * IEEE754倍精度の数値を指定
              * 下限(`min`) < 閾値 < 上限(`max`)である値を指定
          description: |
            値 閾値リスト
            * 1～3要素まで指定可能 (順不同)
            * リスト内で同一の値を指定した場合は1つに統合
          examples:
            - - 50
              - 80
              - 90
      required:
        - value
    IconStatus:
      description: |
        アイコンのステータス情報
      type: object
      properties:
        status:
          $ref: '#/components/schemas/Status'
        message:
          type: 
            - string
            - 'null'
          description: |
            メッセージ
            * 制御文字・サロゲートペア・合成文字は不可
            * 改行は可（"\n"で指定）
            * 200文字まで登録可(超える場合はエラー)
            * HTMLタグが含まれていても通常文字列として処理します。
          examples: ["Gas detected.\nLevel 3"]
        force_show_link:
          type: boolean
          default: false
          description: |
            リンク強制表示
            * `true`: 該当のアイコン情報にリンクが設定されている場合に、起動中のNHE CONNECTでリンク先を強制的にダイアログ表示します。
            * `false`: 上記を行いません。
          examples: [true]
      required:
        - status
    Resetting:
      description: |
        リセット指示状態
        * `true`: リセット指示中
        * `false`: リセット指示なし ※falseの場合はプロパティ省略
      type: boolean
      default: false
      examples: [true]
    IconPosition:
      description: |
        アイコンの位置情報
      type: object
      properties:
        x_pos:
          $ref: '#/components/schemas/XPosition'
        y_pos:
          $ref: '#/components/schemas/YPosition'
        z_pos:
          $ref: '#/components/schemas/ZPosition'
    Alert:
      type: object
      description: |
        警報情報 (故障情報除く)
        * 該当のアイコン情報がない火災警報の場合、`deck`は含まれません。
      properties:
        type:
          $ref: '#/components/schemas/Type'
        zone_address:
          $ref: '#/components/schemas/ZoneAddress'
        description:
          $ref: '#/components/schemas/Description'
        deck:
          $ref: '#/components/schemas/Deck'
        time:
          $ref: '#/components/schemas/Time'
        status:
          $ref: '#/components/schemas/Status'
        message:
          type: string
          description: |
            警報メッセージ
          examples: ["Gest Room 102[Heavy Heat]"]
        resetting:
          $ref: '#/components/schemas/Resetting'
        "_links":
          description: |
            警報情報に対し実行可能なAPIが存在する場合に各Link情報を付加します。
            * queryパラメータで`link=true`の指定がある場合にのみ付加します。

            |プロパティ名|API|備考|
            |----|----|----|
            |`reset`|警報リセット|火災探知装置の火災警報 または リセット指示可能なアイコン種別でかつリセット指示可能なステータス情報が対象になります。|
          type: object
          properties:
            reset:
              $ref: '#/components/schemas/Link'
      required:
        - type
        - status
    Fault:
      type: object
      description: |
        故障情報
        * 該当のアイコン情報がない故障情報の場合、`deck`は含まれません。
      properties:
        type:
          $ref: '#/components/schemas/Type'
        zone_address:
          $ref: '#/components/schemas/ZoneAddress'
        description:
          $ref: '#/components/schemas/Description'
        deck:
          $ref: '#/components/schemas/Deck'
        time:
          $ref: '#/components/schemas/Time'
        fault_status:
          type: string
          description: |
            故障ステータス
            * 火災探知装置のみ、以下のステータスが設定される場合があります。
              * `Serviced`: 復旧済み (未承認)
              * `Acknowledged`: 承認済み (未復旧)
          examples: [Serviced,Acknowledged]
        message:
          type: string
          description: |
            故障情報メッセージ
          examples: ["FAULT: No reply zone 001 address 01 technical number 000001 Serviced[Gest room 101]"]
        "_links":
          description: |
            故障情報に対し実行可能なAPIが存在する場合に各Link情報を付加します。
            * queryパラメータで`link=true`の指定がある場合にのみ付加します。

            |プロパティ名|API|備考|
            |----|----|----|
            |`acknowledge`|故障承認|火災探知装置の故障情報が対象になります。|
          type: object
          properties:
            acknowledge:
              $ref: '#/components/schemas/Link'
      required:
        - type
    Link:
      description: 情報に関連するAPI情報
      type: object
      properties:
        href:
          type: string
          description: URI (相対パス)
          format: uri
        methods:
          type: array
          description: HTTP メソッド
          items:
            type: string
            enum:
              - GET
              - PUT
              - DELETE
    ErrorResponse:
      type: object
      properties:
        title:
          description: エラーコード
          type: string
          examples: [error_code]
        detail:
          description: エラーメッセージ
          type: string
          examples: [Error Message]
        errors:
          description: "エラー詳細(項目別にエラーがある場合のみ)"
          type: array
          items:
            type: object
            properties:
              title:
                description: エラーコード
                type: string
                examples: [not_exists]
              field:
                description: 項目名
                type: string
                examples: [Zone-Address]
              detail:
                description: エラーメッセージ
                type: string
                examples: [Not exists]
            required:
              - title
              - detail
      required:
        - title
        - detail
  securitySchemes:
    api_key:
      type: apiKey
      name: X-API-Key
      in: header
      description: 振り出されているAPIキーを指定してください。
  responses:
    '204_NoContent':
      description: |
        No Content
        * 条件に一致する情報がありませんでした。
    '400':
      description: |
        Bad Request
        * 不正なリクエストであることを示します。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             不正なパラメータ:
               value:
                 title: invalid_param
                 detail: Invalid Parameters
                 errors:
                   - title: unknown_param
                     field: x_pos
                     detail: Unknown parameter
                   - title: invalid_format
                     field: zone_address
                     detail: Invalid format
    '400InvalidRecoveryTime':
      description: |
        Bad Request
        * 不正なリクエストであることを示します。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             必須パラメータなし:
               value:
                 title: invalid_param
                 detail: Invalid Parameters
                 errors:
                   - title: missing_param
                     field: recovery_time
                     detail: Missing parameter
             時刻形式不正:
               value:
                 title: invalid_param
                 detail: Invalid Parameters
                 errors:
                   - title: invalid_format
                     field: recovery_time
                     detail: Invalid format
    '401':
      description: |
        Unauthorized
        * 認証できませんでした。(APIキーの誤り等)
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             認証エラー:
               value:
                 title: unauthorized
                 detail: Unauthorized
    '403NoValue':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             値を持たないアイコン情報:
               value:
                 title: no_value_icon
                 detail: The icon must have no value
             権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NoStatus':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            ステータスを持たないアイコン情報:
              value:
                title: no_status_icon
                detail: The icon must have no status
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NotVisible':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            表示制御不可のアイコン情報:
              value:
                title: non_hidden_icon
                detail: Visibility of that icon is not controlled
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NotResettable':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            リセット指示不可:
              value:
                title: reset_not_allowed
                detail: Reset is not allowed
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NotFireAlarmTestable':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            火災警報テスト発報指示不可:
              value:
                title: firealarm_test_not_allowed
                detail: Fire alarm tests are not allowed
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NotAcknowledgeable':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            承認指示不可:
              value:
                title: acknowledge_not_allowed
                detail: Acknowledgement is not allowed
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NotDisable':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            無効化指示不可:
              value:
                title: disable_not_allowed
                detail: Disablement is not allowed
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '403NotReEnable':
      description: |
        Forbidden
        * 指定の情報に対し、操作が許可されていません。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            無効解除指示不可:
              value:
                title: re_enable_not_allowed
                detail: Re-enablement is not allowed
            権限なし:
               $ref: '#/components/examples/NotAllowed'
    '404':
      description: |
        Not Found
        * 指定のZoneまたはZone-Addressが存在しません。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             情報が存在しない:
               value:
                 title: not_found
                 detail: Not Found
    '415':
      description: |
        Unsupported Media Type
        * `Content-Type`リクエストヘッダーがサポート外です。`application/json`のみ受け付けます。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             サポート外のコンテンツタイプ:
               value:
                 title: unsupported_media_type
                 detail: Unsupported Media Type
    '429':
      description: |
        To Many Requests
        * リクエスト回数が上限に達しました。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             リクエスト回数超過:
               value:
                 title: too_many_requests
                 detail: Too Many Requests
    '500':
      description: |
        Internal Server Error
        * システムエラーが発生しています。
      content:
         application/json:
           schema:
             $ref: '#/components/schemas/ErrorResponse'
           examples:
             サーバエラー:
               value:
                 title: server_error
                 detail: Internal Server Error
  examples:
    FireDetector:
      value:
        type: Heat
        zone_address: 001-01
        tech_no: "000001"
        deck: Main Deck
        visible: true
        values:
          - value: 22.1
            unit: ℃
        x_pos: 0.0234567890123
        y_pos: 0.0234567890123
        z_pos: 3
    Icon:
      value:
        type: Gas
        zone_address: 101-01
        description: Gas G5-1
        deck: Main Deck
        visible: true
        values:
          - value: 0.12
            unit: ppm
        x_pos: 0.1234567890123
        y_pos: 0.1234567890123
        z_pos: 3
    NotAllowed:
      value:
        title: operation_not_allowed
        detail: Operation not allowed
    NoStatusIcon:
      value:
        title: no_status_icon
        detail: The icon must have no status
    MissingParam:
      value:
        title: invalid_param
        detail: Invalid Parameters
        errors:
          - title: missing_param
            field: zone_address
            detail: Missing parameter
